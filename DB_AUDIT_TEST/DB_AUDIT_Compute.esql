

CREATE COMPUTE MODULE DB_AUDIT_Compute
	CREATE FUNCTION Main() RETURNS BOOLEAN
	BEGIN
  		 CALL DBAUDIT_DATA();
		RETURN TRUE;
	END;


	CREATE PROCEDURE DBAUDIT_DATA() BEGIN  
		
		DECLARE dbref REFERENCE TO InputRoot.JSON.Data.DB_LOGGING; 
	
		CALL DBAUDIT_REQUEST(dbref.msgId,dbref.serverIp,dbref.brokerName,dbref.egName,dbref.createdBy,CAST(dbref.msgTime AS TIMESTAMP) ,dbref.payload,CAST(dbref.payloadTime AS TIMESTAMP),dbref.payloadTP,CAST(dbref.payloadTPTime AS TIMESTAMP));
	END;
END MODULE;  



CREATE PROCEDURE DBAUDIT_REQUEST(IN MSG_ID CHARACTER,IN SERVER_IP CHARACTER,IN BROKER_NAME CHARACTER,
IN EG_NAME CHARACTER,IN CREATED_BY CHARACTER,IN MSG_TIME TIMESTAMP,IN PAYLOAD_REQUEST CHARACTER,IN PAYLOAD_REQ_TIME TIMESTAMP,IN PAYLOADTP_REQUEST CHARACTER,IN PAYLOADTP_REQ_TIME TIMESTAMP)
LANGUAGE DATABASE
EXTERNAL NAME STEWARD_DBAUDIT_REQUEST;


CREATE PROCEDURE DBAUDIT_RESPONCE(IN MSG_ID CHARACTER,IN SERVER_IP CHARACTER,IN BROKER_NAME CHARACTER,
IN EG_NAME CHARACTER,IN CREATED_BY CHARACTER,IN MSG_TIME TIMESTAMP,IN PAYLOAD_RESPONSE CHARACTER ,IN PAYLOAD_RES_TIME TIMESTAMP,IN PAYLOADTP_RESPONSE CHARACTER,IN PAYLOADTP_RES_TIME TIMESTAMP,IN STATUS CHARACTER,IN ERROR_CODE CHARACTER,IN ERROR_DESC CHARACTER,IN ERROR_TYPE CHARACTER,IN RESPONCE_CODE INTEGER)
LANGUAGE DATABASE
EXTERNAL NAME STEWARD_DBAUDIT_RESPONCE;

